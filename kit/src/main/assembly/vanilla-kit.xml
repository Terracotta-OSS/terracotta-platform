<!--

    Copyright Terracotta, Inc.

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd">

  <id>vanilla-kit</id>

  <formats>
    <!-- dir is ti keep an extracted version of the kit, which is useful to debug and see what Maven did-->
    <format>dir</format>
    <format>zip</format>
    <format>tar.gz</format>
  </formats>

  <fileSets>
    <fileSet>
      <outputDirectory>.</outputDirectory>
      <directory>${project.build.directory}/terracotta-kit-${terracotta-core.version}/terracotta-${terracotta-core.version}</directory>
      <useDefaultExcludes>false</useDefaultExcludes>
      <includes>
        <include>**/*</include>
      </includes>
      <excludes>
        <exclude>server/bin/**</exclude>
        <exclude>server/conf/**</exclude>
      </excludes>
    </fileSet>
    <fileSet>
      <outputDirectory>.</outputDirectory>
      <directory>src/main/kit</directory>
      <fileMode>0755</fileMode>
    </fileSet>
  </fileSets>

  <dependencySets>
    <dependencySet>
      <outputDirectory>server/plugins/lib</outputDirectory>
      <includes>
        <include>org.terracotta.common:common-inet-support</include>
        <include>org.terracotta.common:common-nomad</include>
        <include>org.terracotta.common:common-structures</include>
        <include>org.terracotta.dynamic-config:dynamic-config-api</include>
        <include>org.terracotta.dynamic-config:dynamic-config-model</include>
        <include>com.fasterxml.jackson.core:jackson-annotations</include>
        <include>org.terracotta.management.dist:mnm-common</include>
        <include>org.terracotta.management.dist:mnm-server-api</include>
        <include>org.terracotta:statistics</include>
      </includes>
    </dependencySet>

    <dependencySet>
      <outputDirectory>server/plugins/lib</outputDirectory>
      <includes>
        <include>net.bytebuddy:byte-buddy</include>
        <include>io.github.classgraph:classgraph</include>
        <include>org.terracotta.common:common-json-support</include>
        <include>org.terracotta.common:common-sanskrit</include>
        <include>org.terracotta:data-root-resource</include>
        <include>org.terracotta.diagnostic:diagnostic-common</include>
        <include>org.terracotta.diagnostic:diagnostic-server</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-management-entity-server</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-nomad-entity-common</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-nomad-entity-server</include>
        <include>org.terracotta.dynamic-config:dynamic-config-server</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-topology-entity-common</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-topology-entity-server</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-common</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-mapping-oss</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-topology</include>
        <include>com.fasterxml.jackson.core:jackson-core</include>
        <include>com.fasterxml.jackson.core:jackson-databind</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jdk8</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jsr310</include>
        <include>com.beust:jcommander</include>
        <include>org.terracotta:lease-common</include>
        <include>org.terracotta:lease-config</include>
        <include>org.terracotta:lease-entity-common</include>
        <include>org.terracotta:lease-entity-server</include>
        <include>org.terracotta.management.dist:mnm-server</include>
        <include>org.terracotta:offheap-resource</include>
        <include>org.terracotta:runnel</include>
      </includes>
    </dependencySet>

    <dependencySet>
      <outputDirectory>tools/config-tool/lib</outputDirectory>
      <includes>
        <include>io.github.classgraph:classgraph</include>
        <include>org.terracotta.internal:client-runtime</include>
        <include>org.terracotta.common:common-inet-support</include>
        <include>org.terracotta.common:common-json-support</include>
        <include>org.terracotta.common:common-nomad</include>
        <include>org.terracotta.common:common-structures</include>
        <include>org.terracotta.diagnostic:diagnostic-client</include>
        <include>org.terracotta.diagnostic:diagnostic-common</include>
        <include>org.terracotta.dynamic-config:dynamic-config-api</include>
        <include>org.terracotta.dynamic-config.cli:dynamic-config-cli-config-tool</include>
        <include>org.terracotta.dynamic-config.cli:dynamic-config-cli-support</include>
        <include>org.terracotta.dynamic-config:dynamic-config-model</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-nomad-entity-client</include>
        <include>org.terracotta.dynamic-config.entities:dynamic-config-nomad-entity-common</include>
        <include>com.fasterxml.jackson.core:jackson-annotations</include>
        <include>com.fasterxml.jackson.core:jackson-core</include>
        <include>com.fasterxml.jackson.core:jackson-databind</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jdk8</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jsr310</include>
        <include>com.beust:jcommander</include>
        <include>ch.qos.logback:logback-classic</include>
        <include>ch.qos.logback:logback-core</include>
        <include>org.slf4j:slf4j-api</include>
      </includes>
    </dependencySet>

    <dependencySet>
      <outputDirectory>tools/config-convertor/lib</outputDirectory>
      <includes>
        <include>net.bytebuddy:byte-buddy</include>
        <include>io.github.classgraph:classgraph</include>
        <include>org.terracotta.common:common-inet-support</include>
        <include>org.terracotta.common:common-json-support</include>
        <include>org.terracotta.common:common-nomad</include>
        <include>org.terracotta.common:common-sanskrit</include>
        <include>org.terracotta.common:common-structures</include>
        <include>org.terracotta:data-root-resource</include>
        <include>org.terracotta.diagnostic:diagnostic-common</include>
        <include>org.terracotta.diagnostic:diagnostic-server</include>
        <include>org.terracotta.dynamic-config:dynamic-config-api</include>
        <include>org.terracotta.dynamic-config.cli:dynamic-config-cli-config-convertor</include>
        <include>org.terracotta.dynamic-config.cli:dynamic-config-cli-support</include>
        <include>org.terracotta.dynamic-config:dynamic-config-model</include>
        <include>org.terracotta.dynamic-config:dynamic-config-server</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-common</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-mapping-oss</include>
        <include>org.terracotta.dynamic-config.xml:dynamic-config-xml-topology</include>
        <include>com.fasterxml.jackson.core:jackson-annotations</include>
        <include>com.fasterxml.jackson.core:jackson-core</include>
        <include>com.fasterxml.jackson.core:jackson-databind</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jdk8</include>
        <include>com.fasterxml.jackson.datatype:jackson-datatype-jsr310</include>
        <include>com.beust:jcommander</include>
        <include>org.terracotta:lease-config</include>
        <include>ch.qos.logback:logback-classic</include>
        <include>ch.qos.logback:logback-core</include>
        <include>org.terracotta:offheap-resource</include>
        <include>org.slf4j:slf4j-api</include>
      </includes>
    </dependencySet>
  </dependencySets>

</assembly>
